<!DOCTYPE html>
<html>
<head>
  <title>Setup Profile | SmartPeer</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Styling to match your screenshot exactly */
    .profile-card { max-width: 600px; margin: 40px auto; padding: 30px; background: #fff; border-radius: 16px; color: #1e293b; }
    .section-title { font-weight: 700; margin: 25px 0 10px; display: block; color: #334155; }
    .skills-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
    .skill-item {
  background: #f8fafc;
  padding: 12px 15px;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
  cursor: pointer;
  color: #475569;
  font-size: 0.9rem;
  
  /* Alignment Fix */
  display: grid;
  grid-template-columns: 20px 1fr; /* 20px for checkbox, rest for text */
  align-items: center;
  text-align: center; /* Centers the text in its column */
}

.skill-item input {
  margin: 0;
  justify-self: start; /* Keeps checkbox strictly to the left */
}

.skill-item span {
  width: 100%;
  padding-right: 20px; /* Counter-balances the checkbox width to keep text perfectly centered */
}
    .pace-group { display: flex; gap: 15px; margin-top: 10px; }
    .pace-item { flex: 1; padding: 15px; border: 1px solid #e2e8f0; border-radius: 12px; text-align: center; cursor: pointer; background: #f8fafc; }
    .pace-item input { margin-bottom: 8px; }
    input[type="text"], select { width: 100%; padding: 12px; border: 1px solid #e2e8f0; border-radius: 8px; background: white; color: #1e293b; }
    .btn-save { width: 100%; padding: 16px; background: #2563eb; color: white; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; margin-top: 30px; }
  </style>
</head>
<body style="background: #f1f5f9;">

  <div class="profile-card">
    <h2 style="color: #2563eb; margin-bottom: 10px;">Create Your Profile</h2>
    
    <form id="profileForm">
      <label class="section-title">Name *</label>
      <input type="text" id="name" placeholder="Your full name" required>

      <label class="section-title">Skills *</label>
      <div class="skills-grid" id="skillsGrid">
        </div>
      <input type="text" id="customSkill" placeholder="Add a custom skill and press Enter" style="margin-top: 10px;">

      <label class="section-title">Interests</label>
      <div class="skills-grid" id="interestsGrid">
        <label class="skill-item"><input type="checkbox" class="interest-cb" value="Hackathons"> Hackathons</label>
        <label class="skill-item"><input type="checkbox" class="interest-cb" value="Placements"> Placements</label>
        <label class="skill-item"><input type="checkbox" class="interest-cb" value="Learning"> Learning</label>
      </div>

      <label class="section-title">Goal *</label>
      <select id="goal" required>
        <option value="">Select a goal</option>
        <option value="Web Developer">Web Developer</option>
        <option value="Data Scientist">Data Scientist</option>
        <option value="UI/UX Designer">UI/UX Designer</option>
      </select>

      <label class="section-title">Learning Pace *</label>
      <div class="pace-group">
        <label class="pace-item"><input type="radio" name="pace" value="Slow" required><br>Slow</label>
        <label class="pace-item"><input type="radio" name="pace" value="Medium"><br>Medium</label>
        <label class="pace-item"><input type="radio" name="pace" value="Fast"><br>Fast</label>
      </div>

      <button type="submit" class="btn-save">Save Profile</button>
    </form>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  
  <script>
    // USE YOUR ACTUAL CONFIG FROM AUTH.HTML
    const firebaseConfig = {
      apiKey: "AIzaSyBkNUkZVM9FzJMcouzSVdMPRXHlEK52UYs",
      authDomain: "smartpeermatching.firebaseapp.com",
      projectId: "smartpeermatching",
      storageBucket: "smartpeermatching.firebasestorage.app",
      messagingSenderId: "192356601698",
      appId: "1:192356601698:web:04ab211dedf555cd82263b"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Populate Skills Grid
   const skillList = ["HTML", "CSS", "JavaScript", "React", "Node.js", "Express", "Java", "Python", "MySQL", "MongoDB", "Firebase", "Machine Learning", "Git", "GitHub", "AWS"];
const grid = document.getElementById('skillsGrid');

skillList.forEach(s => {
  // Added <span> around the skill name for better alignment control
  grid.innerHTML += `
    <label class="skill-item">
      <input type="checkbox" class="skill-cb" value="${s}">
      <span>${s}</span> 
    </label>`;
});
    document.getElementById('profileForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const user = firebase.auth().currentUser;
      
      if (user) {
        // Collect checked items
        const selectedSkills = Array.from(document.querySelectorAll('.skill-cb:checked')).map(el => el.value).join(', ');
        const selectedInterests = Array.from(document.querySelectorAll('.interest-cb:checked')).map(el => el.value).join(', ');

  await db.collection('profiles').doc(user.uid).set({
  name: document.getElementById('name').value,
  email: user.email, // Always save the email for the dashboard to use
  skills: selectedSkills,
  interests: selectedInterests,
  goal: document.getElementById('goal').value,
  pace: document.querySelector('input[name="pace"]:checked').value,
  pic: "ðŸ‘¤", // Default picture for the dashboard
  updated: firebase.firestore.FieldValue.serverTimestamp()
}, { merge: true }); // Use merge to prevent data loss
        
        window.location.href = 'home.html'; // Redirect to Dashboard after saving
      }
    });
 document.getElementById('customSkill').addEventListener('keypress', function (e) {
  if (e.key === 'Enter') {
    e.preventDefault();
    const val = this.value.trim();
    if (val) {
      const grid = document.getElementById('skillsGrid');
      
      // Create a new element instead of overwriting innerHTML
      const label = document.createElement('label');
      label.className = 'skill-item';
      label.innerHTML = `<input type="checkbox" class="skill-cb" value="${val}" checked> ${val}`;
      
      grid.appendChild(label); // This keeps all other checkboxes checked!
      this.value = ''; 
    }
  }
});
  </script>
</body>
</html>